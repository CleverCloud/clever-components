import"./cc-env-var-form-c46cede9.js";import"./cc-smart-container-f668ab58.js";import{g as a,u as e}from"./application-e1aa8d7f.js";import{c as t}from"./env-vars-57e1e34b.js";import{f as n}from"./api-helpers-f5c0afc4.js";import{d as i}from"./request.fetch-17efde15.js";import{b as o,a as s}from"./notifications-1d2a2395.js";import{s as r}from"./send-to-api-3f46dae0.js";function p({apiConfig:e,signal:t,ownerId:n,appId:i}){return a({id:n,appId:i}).then(r({apiConfig:e,signal:t})).then((a=>Object.entries(a).map((([a,e])=>({name:a,value:e})))))}i({selector:'cc-env-var-form[context="exposed-config"]',params:{apiConfig:{type:Object},ownerId:{type:String},appId:{type:String}},onContextUpdate({context:a,onEvent:i,updateComponent:d,signal:c}){d("state",{type:"loading"});const{apiConfig:f,ownerId:m,appId:l}=a;Promise.all([n({apiConfig:f,signal:c,ownerId:m,appId:l}),p({apiConfig:f,signal:c,ownerId:m,appId:l})]).then((([a,e])=>{d("appName",a.name),d("state",{type:"loaded",validationMode:"simple",variables:e})})).catch((a=>{console.error(a),d("state",{type:"error"})})),i("cc-env-var-form:submit",(a=>{d("state",(a=>{a.type="saving"})),function({apiConfig:a,signal:n,ownerId:i,appId:o,variables:s}){const p=t(s);return e({id:i,appId:o},p).then(r({apiConfig:a,signal:n}))}({apiConfig:f,ownerId:m,appId:l,variables:a}).then((()=>{d("state",(e=>{e.variables=a})),o("Les variables ont été mises à jour avec succès.")})).catch((()=>s("Une erreur est survenue pendant la mise à jour des variables."))).finally((()=>{d("state",(a=>{a.type="loaded"}))}))}))}});
