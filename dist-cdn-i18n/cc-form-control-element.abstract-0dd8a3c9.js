import{d as t}from"./events-4c8e3503.js";import{i as e}from"./utils-aa566623.js";import{s as r}from"./lit-element-98ed46d4.js";function s(t,e,r=null){const s=t?.querySelector(e);"function"==typeof s?.focus?s.focus():r?.()}function i(t){const e=new FormData(t);return Object.fromEntries(Array.from(e.keys()).map((t=>{const r=e.getAll(t);return 0===r.length?null:1===r.length?[t,r[0]]:[t,r]})).filter((t=>null!=t)))}function a(t){return t instanceof f}function n(t){return!function(t){return t instanceof HTMLButtonElement||t instanceof HTMLInputElement&&l.includes(t.type)}(t)&&"function"==typeof t.checkValidity&&void 0!==t.willValidate&&void 0!==t.validationMessage}const l=["button","reset","submit"];function o(t){s(t,":invalid, [internals-invalid]")}class u{static VALID={valid:!0};static invalid(t){return{valid:!1,code:t}}}class h{validate(t,e){return this._isEmpty(t)?u.invalid("empty"):u.VALID}_isEmpty(t){return null==t||("string"==typeof t?0===t.length:"number"==typeof t?Number.isNaN(t):!!Array.isArray(t)&&0===t.length)}}class m{constructor({min:t,max:e}={}){this._min=t,this._max=e}validate(t,e){const r=this._parse(t);if(null==r||isNaN(r))return u.invalid("badType");const s=this._getRange();return null==s?u.VALID:r<s.min?u.invalid("rangeUnderflow"):r>s.max?u.invalid("rangeOverflow"):u.VALID}_parse(t){return"number"==typeof t?t:"string"==typeof t?Number(t):null}_getRange(){return null==this._min&&null==this._max?null:{min:this._min??-1/0,max:this._max??1/0}}}class d{validate(t,e){return t.match(/^\S+@\S+\.\S+$/gm)?u.VALID:u.invalid("badEmail")}}const c=new class{validate(t,e){return u.VALID}};function g(t){const e=t.filter((t=>null!=t));return 0===e.length?c:1===e.length?e[0]:y(((t,r)=>{for(const s of e){const e=s.validate(t,r);if(!1===e.valid)return e}return u.VALID}))}function y(t){return{validate:t}}class f extends r{static get formAssociated(){return!0}static get properties(){return{customErrorMessages:{type:Object,attribute:!1},customValidator:{type:Object,attribute:!1},errorMessage:{type:Object,attribute:"error-message"},name:{type:String,reflect:!0}}}constructor(){super(),this.customErrorMessages=null,this.customValidator=null,this.errorMessage=null,this.name=null,this._errorState={message:null,validity:null},this._internals=this.attachInternals()}_getValuePropertyName(){return"value"}_getResetPropertyName(){return"resetValue"}_getFormControlElement(){throw new Error("You must implement _getFormControlElement() abstract method")}_getErrorElement(){throw new Error("You must implement _getErrorElement() abstract method")}_getErrorMessages(){return null}_getValidator(){return null}_getFormControlData(){const t=this.$getValue();return null==t||"string"==typeof t||t instanceof File||t instanceof FormData?t:(console.warn("The value to set to form data should be of type `null|File|string|FormData`. You've got ",t),t.toString())}_getReactiveValidationProperties(){return[]}validate(){const t={...this._getErrorMessages(),...this.customErrorMessages??{}},e=g([this._getValidator(),this.customValidator]).validate(this.$getValue(),null!=this._internals.form?i(this._internals.form):{}),r=!0===e.valid?null:this.$resolveErrorMessage(e.code,t);var s;return this._errorState={message:r,validity:e},e.valid?this.$setValidValidity():this.$setInvalidValidity(null==(s=r)?"":"string"==typeof s?s:(s instanceof HTMLElement&&(s.innerHTML=s.innerHTML.replace("<br>"," ")),s instanceof Node?s.textContent:s)),e}reportInlineValidity(){return this.errorMessage!==this._errorState.message&&(this.errorMessage=this._errorState.message,t(this,"error-message-change",this.errorMessage)),this._errorState.validity.valid}get inlineValidity(){return this._errorState.validity}formResetCallback(){this.$resetValue(),this.validate(),null!=this._errorState.message&&(this.errorMessage=null,t(this,"error-message-change",null))}get willValidate(){return this._internals.willValidate}checkValidity(){return this._internals.checkValidity()}reportValidity(){return this._internals.reportValidity()}get validity(){return this._internals.validity}get validationMessage(){return this._internals.validationMessage}setCustomValidity(t){e(t)?this.$setValidValidity():this.$setInvalidValidity(t)}updated(t){let e=!1;const r=t.has("errorMessage"),s=null==this.errorMessage||"string"==typeof this.errorMessage&&0===this.errorMessage.length;t.has(this._getValuePropertyName())&&(this._internals.setFormValue(this._getFormControlData()),e=!0);if(this._getReactiveValidationProperties().some((e=>t.has(e)))&&(e=!0),r&&s&&(e=!0),(t.has("customValidator")||t.has("customErrorMessages"))&&(e=!0),r&&!s){let t;t="string"==typeof this.errorMessage?this.errorMessage:this._getErrorElement().innerText.replace("\n"," "),this.$setInvalidValidity(t),e=!1}e&&this.validate()}$getValue(){return this[this._getValuePropertyName()]}$resetValue(){const t=this[this._getResetPropertyName()];null!=t&&(this[this._getValuePropertyName()]=t)}$resolveErrorMessage(t,e){const r=e?.[t];return("function"==typeof r?r():r)??t}$setValidValidity(){this._internals.setValidity({})}$setInvalidValidity(t){this._internals.setValidity({customError:!0},t,this._getFormControlElement())}}export{f as C,d as E,m as N,h as R,u as V,s as a,n as b,g as c,y as d,o as f,i as g,a as i};
