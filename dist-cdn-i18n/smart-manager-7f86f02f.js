import{o as e}from"./utils-aa566623.js";const t=Symbol("COMPONENTS"),n=Symbol("CURRENT_CONTEXT"),o=Symbol("LAST_CONTEXT");let r={};const c=new Set,a=new Set;function i(e,o){e[t]=new Map,c.add(e);const r=new MutationObserver((()=>s()));r.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeOldValue:!0}),o.addEventListener("abort",(()=>{r.disconnect(),c.delete(e),e[t].forEach(((t,n)=>{t.forEach((t=>d(e,n,t)))})),delete e[t],delete e[n]}),{once:!0})}function l(e,n){a.add(e),s(),null!=n&&n.addEventListener("abort",(()=>{a.delete(e),c.forEach((n=>{(n[t].get(e)??[]).forEach((t=>d(n,e,t))),n[t].delete(e)}))}),{once:!0})}function s(){const i=[],l=[],s=[];c.forEach((e=>{a.forEach((n=>{const o=Array.from(e.querySelectorAll(n.selector)).filter((t=>{return n="cc-smart-container",t.parentElement.closest(n)===e;var n})),r=e[t].get(n)??[];e[t].set(n,o),o.filter((e=>!r.includes(e))).forEach((t=>l.push([e,n,t]))),o.filter((e=>r.includes(e))).forEach((t=>s.push([e,n,t]))),r.filter((e=>!o.includes(e))).forEach((t=>i.push([e,n,t])))}))})),i.forEach((([e,t,n])=>d(e,t,n))),l.forEach((([e,t,n])=>function(e,t,n){n[o]={},t.onConnect?.(e,n)}(e,t,n))),[...l,...s].forEach((([t,c,a])=>function(t,c,a){const i={...r,...t[n]},l=function(e,t){if(null==e)return{};if(null==t)return e;const n=Object.keys(t).map((t=>[t,e[t]])).filter((([e,t])=>void 0!==t));return Object.fromEntries(n)}(i,c.params);if(e(a[o],l))return;a[o]=l,c.onContextUpdate?.(t,a,l)}(t,c,a)))}function f(e,t){e[n]=t,s()}function u(e){r=e,s()}function d(e,t,n){delete n[o],t.onDisconnect?.(e,n)}export{l as defineSmartComponentCore,i as observeContainer,f as updateContext,u as updateRootContext};
