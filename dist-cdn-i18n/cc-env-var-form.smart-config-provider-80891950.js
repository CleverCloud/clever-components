import"./cc-env-var-form-c46cede9.js";import"./cc-smart-container-f668ab58.js";import{a as e}from"./addon-d08729a3.js";import{d as n}from"./request.fetch-17efde15.js";import{b as a,a as o}from"./notifications-1d2a2395.js";import{s as d}from"./send-to-api-3f46dae0.js";function t(e){return Promise.resolve({method:"get",url:`/v4/addon-providers/config-provider/addons/${e.realAddonId}/env`,headers:{Accept:"application/json"}})}function r(e,n){return Promise.resolve({method:"put",url:`/v4/addon-providers/config-provider/addons/${e.realAddonId}/env`,headers:{Accept:"application/json","Content-Type":"application/json"},body:n})}n({selector:'cc-env-var-form[context="config-provider"]',params:{apiConfig:{type:Object},ownerId:{type:String},addonId:{type:String}},onContextUpdate({context:n,onEvent:i,updateComponent:s,signal:p}){s("state",{type:"loading"});const{apiConfig:l,ownerId:c,addonId:f}=n;let g=null;(function({apiConfig:n,signal:a,ownerId:o,addonId:t}){return e({id:o,addonId:t}).then(d({apiConfig:n,signal:a}))})({apiConfig:l,ownerId:c,addonId:f,signal:p}).then((e=>(s("addonName",e.name),g=e.realId,async function({apiConfig:e,signal:n,realAddonId:a}){return t({realAddonId:a}).then(d({apiConfig:e,signal:n}))}({apiConfig:l,realAddonId:g,signal:p})))).then((e=>{s("state",{type:"loaded",validationMode:"simple",variables:e})})).catch((e=>{console.error(e),s("state",{type:"error"})})),i("cc-env-var-form:submit",(e=>{s("state",(e=>{e.type="saving"})),async function({apiConfig:e,signal:n,realAddonId:a,variables:o}){return r({realAddonId:a},o).then(d({apiConfig:e,signal:n}))}({apiConfig:l,realAddonId:g,variables:e}).then((()=>{s("state",(n=>{n.variables=e})),a("Les variables ont été mises à jour avec succès.")})).catch((()=>o("Une erreur est survenue pendant la mise à jour des variables."))).finally((()=>{s("state",(e=>{e.type="loaded"}))}))}))}});export{t as getConfigProviderEnv,r as updateConfigProviderEnv};
