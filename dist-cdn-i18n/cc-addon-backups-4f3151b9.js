import{s as e,f as t,a as s,b as r}from"./i18n-bf531c19.js";import"./cc-button-0fc35634.js";import"./cc-input-text-215605a4.js";import"./cc-block-section-d9dd6090.js";import"./cc-block-4351d64f.js";import"./cc-error-8d730ec3.js";import{L as a,h as o,a as c,s as i,c as n}from"./vendor-5e139a4e.js";import{f as l}from"./fake-strings-0d4d5c0b.js";import{c as d,l as u}from"./cc-link-bb132771.js";const p=()=>e`You can delete this backup using <a href="https://curl.se/docs/">cURL</a> by executing this command:`,h=()=>e`Backups are created using the <a href="https://docs.mongodb.com/v4.0/reference/program/mongodump/">mongodump</a> tool.`,b=()=>e`Backups are created using the <a href="https://dev.mysql.com/doc/refman/8.0/en/mysqldump.html">mysqldump</a> tool.`,m=()=>e`Backups are created using the <a href="https://www.postgresql.org/docs/current/app-pgdump.html">pg_dump</a> tool.`,g=()=>e`You can restore this backup using <a href="https://curl.se/docs/">cURL</a> by executing this command:`,k=()=>e`You can restore this backup using the <a href="https://docs.mongodb.com/v4.0/reference/program/mongorestore/">mongorestore</a> tool by executing this command:`,v=()=>e`You can restore this backup using the <a href="https://dev.mysql.com/doc/refman/8.0/en/mysql.html">mysql</a> CLI by executing this command:`,y=()=>e`You can restore this backup using the <a href="https://www.postgresql.org/docs/current/app-pgrestore.html">pg_restore</a> tool by executing this command:`,f=new URL(new URL("assets/backup-5902d4d1.svg",import.meta.url).href,import.meta.url).href,$=new URL(new URL("assets/close-5578d4ce.svg",import.meta.url).href,import.meta.url).href,_={providerId:"",passwordForCommand:"",list:new Array(5).fill({createdAt:new Date,expiresAt:new Date})};class w extends a{static get properties(){return{backups:{type:Object},error:{type:Boolean},_overlay:{type:String,attribute:!1},_selectedBackup:{type:Object,attribute:!1}}}constructor(){super(),this.error=!1,this._overlay=null,this._selectedBackup=null}_getDescription(e){switch(e){case"es-addon":return"Backups are managed by Elasticsearch itself. You can define the retention period and backup frequency through Kibana's UI.";case"es-addon-old":return"Backups are managed by Elasticsearch itself. The version of your Elasticsearch does not allow to define a retention policy. Deleting a backup can be done manually through Elasticsearch's API.";case"postgresql-addon":return m;case"mysql-addon":return b;case"mongodb-addon":return h;case"redis-addon":return"Backups are created by archiving Redis's data.";case"jenkins":return"Backups are created by archiving Jenkins's data.";default:return l(150)}}_getBackupText({createdAt:a,expiresAt:o}){return null!=o?(({createdAt:a,expiresAt:o})=>e`Backup from <strong title="${t("en",a)}">${s("en",a)}</strong> (expires on <strong>${r("en",o)}</strong>)`)({createdAt:a,expiresAt:o}):(({createdAt:r})=>e`Backup from <strong title="${t("en",r)}">${s("en",r)}</strong> (expires after defined retention)`)({createdAt:a})}_getBackupLink(e){switch(e){case"es-addon":return"open in Kibana";case"es-addon-old":return"open in Elasticsearch";case"postgresql-addon":case"mysql-addon":case"mongodb-addon":case"redis-addon":case"jenkins":return"download";default:return l(18)}}_displaySectionWithService(e){switch(e){case"es-addon":return!0;case"es-addon-old":default:return!1}}_getRestoreWithServiceTitle(e){switch(e){case"es-addon":return"Restore with Kibana";default:return l(20)}}_getRestoreWithServiceDescription(t,s){switch(t){case"es-addon":return(({href:t})=>e`You can restore this backup using Kibana by going to the <a href="${t}">backup repository</a>.`)({href:s});default:return l(80)}}_getManualRestoreDescription(e){switch(e){case"es-addon":case"es-addon-old":return g;case"postgresql-addon":return y;case"mysql-addon":return v;case"mongodb-addon":return k;case"redis-addon":return"Restoring a Redis backup must be done by our support team. Please open a support ticket containing the add-on ID and the backup to restore and we will do it for you.";case"jenkins":return"Restoring a Jenkins backup must be done by our support team. Please open a support ticket containing the add-on ID and the backup to restore and we will do it for you.";default:return l(70)}}_getDeleteWithServiceTitle(e){switch(e){case"es-addon":return"Delete with Kibana";default:return l(20)}}_getDeleteWithServiceDescription(t,s){switch(t){case"es-addon":return(({href:t})=>e`You can delete this backup using Kibana by going to the <a href="${t}">backup repository</a>.`)({href:s});default:return l(80)}}_getManualDeleteDescription(e){switch(e){case"es-addon":case"es-addon-old":return p;default:return l(70)}}_onOpenOverlay(e,t,s){this._overlay=t,this._selectedBackup=s,this._overlayTarget=e.target,this.updateComplete.then((()=>{this.shadowRoot.querySelector(".overlay cc-button").focus(),this.shadowRoot.querySelector(".overlay").scrollIntoView({behavior:"smooth",block:"center"})}))}_onCloseOverlay(){this._overlay=null,this._selectedBackup=null,this.updateComplete.then((()=>{this._overlayTarget.focus(),this._overlayTarget.scrollIntoView({behavior:"smooth",block:"center"}),this._overlayTarget=null}))}render(){const r=null==this.backups,{providerId:a,list:i,passwordForCommand:n}=r?_:this.backups,l=!this.error&&i.length>0,u=!this.error&&0===i.length;return o`<cc-block><div slot=title>Backups</div>${l?o`<div><span class=${c({skeleton:r})}>${this._getDescription(a)}</span></div><div class=backup-list>${i.map((e=>o`<div class=backup><span class=backup-icon><img src=${f} alt=""></span><span class=backup-text><span class="${c({skeleton:r})} backup-text-details">${this._getBackupText(e)}</span><br>${d(null==this._overlay?e.url:null,this._getBackupLink(a),r)}<cc-button link ?disabled=${null!=this._overlay} ?skeleton=${r} @cc-button:click=${t=>this._onOpenOverlay(t,"restore",e)}>restore...</cc-button>${null!=e.deleteCommand?o`<cc-button link ?disabled=${null!=this._overlay} ?skeleton=${r} @cc-button:click=${t=>this._onOpenOverlay(t,"delete",e)}>delete...</cc-button>`:""}</span></div>`))}</div>`:""} ${u?o`<div class=cc-block_empty-msg>There are no backups yet.</div>`:""} ${this.error?o`<cc-error>Something went wrong while loading the backups.</cc-error>`:""} ${"restore"===this._overlay?o`<div slot=overlay><cc-block class=overlay><div slot=title>${(({createdAt:r})=>e`Restore the backup from <strong title="${t("en",r)}">${s("en",r)}</strong>`)(this._selectedBackup)}</div><cc-button slot=button image=${$} hide-text @cc-button:click=${this._onCloseOverlay}>Close this panel</cc-button>${this._displaySectionWithService(a)?o`<cc-block-section><div slot=title>${this._getRestoreWithServiceTitle(a)}</div><div>${this._getRestoreWithServiceDescription(a,this._selectedBackup.url)}</div></cc-block-section>`:""}<cc-block-section><div slot=title>Restore manually</div><div>${this._getManualRestoreDescription(a)}</div>${null!=this._selectedBackup.restoreCommand?o`<cc-input-text readonly=readonly clipboard value=${this._selectedBackup.restoreCommand}></cc-input-text><div>This command will ask for your password, here it is:</div><cc-input-text readonly=readonly clipboard secret value=${n}></cc-input-text>`:""}</cc-block-section></cc-block></div>`:""} ${"delete"===this._overlay?o`<div slot=overlay><cc-block class=overlay><div slot=title>${(({createdAt:r})=>e`Delete the backup from <strong title="${t("en",r)}">${s("en",r)}</strong>`)(this._selectedBackup)}</div><cc-button slot=button image=${$} hide-text @cc-button:click=${this._onCloseOverlay}>Close this panel</cc-button>${this._displaySectionWithService(a)?o`<cc-block-section><div slot=title>${this._getDeleteWithServiceTitle(a)}</div><div>${this._getDeleteWithServiceDescription(a,this._selectedBackup.url)}</div></cc-block-section>`:""}<cc-block-section><div slot=title>Delete manually</div><div>${this._getManualDeleteDescription(a)}</div><cc-input-text readonly=readonly clipboard value=${this._selectedBackup.deleteCommand}></cc-input-text><div>This command will ask for your password, here it is:</div><cc-input-text readonly=readonly clipboard secret value=${n}></cc-input-text></cc-block-section></cc-block></div>`:""}</cc-block>`}static get styles(){return[i,u,n`:host{display:grid;grid-gap:1rem;line-height:1.5}.backup-list{display:grid;grid-gap:1.5rem}.backup{display:flex;line-height:1.5rem}.backup-icon,.backup-text{margin-right:.5rem}.backup-icon{flex:0 0 auto;height:1.5rem;width:1.5rem}.backup-icon img{display:block;height:100%;width:100%}.backup-text{color:#555}.backup-text-details:not(.skeleton) strong{color:#000}[title]{cursor:help}.skeleton{background-color:#bbb}.overlay{box-shadow:0 0 1rem #aaa;margin:2rem;max-width:80%}.cc-link,cc-button[link]{margin-right:.5rem;vertical-align:baseline}`]}}window.customElements.define("cc-addon-backups",w);export{w as CcAddonBackups};
