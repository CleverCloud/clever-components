import{j as e,s as t,i as s,e as o}from"./i18n-bf531c19.js";import"./cc-button-0fc35634.js";import"./cc-error-8d730ec3.js";import{C as i,A as a,D as r,j as n,p as c}from"./chart.esm-dc52f043.js";import{e as l,N as d,T as u,f as h,r as p,L as m,h as b,a as f,s as g,c as _}from"./vendor-5e139a4e.js";import{t as y}from"./info-tiles-0fcdc9dd.js";import{l as v}from"./cc-link-bb132771.js";const w=o("en"),T=()=>t`<a href="https://developer.mozilla.org/en/docs/Web/HTTP/Status">HTTP response status codes (MDN)</a>`,k=new WeakMap,R=l((e=>t=>{if(!(t instanceof d))throw new Error("cache can only be used in text bindings");let s=k.get(t);void 0===s&&(s=new WeakMap,k.set(t,s));const o=t.value;if(o instanceof u){if(e instanceof h&&o.template===t.options.templateFactory(e))return void t.setValue(e);{let e=s.get(o.template);void 0===e&&(e={instance:o,nodes:document.createDocumentFragment()},s.set(o.template,e)),p(e.nodes,t.startNode.nextSibling,t.endNode)}}if(e instanceof h){const o=t.options.templateFactory(e),i=s.get(o);void 0!==i&&(t.setValue(i.nodes),t.commit(),t.value=i.instance)}t.setValue(e)}));var x={100:"Continue",101:"Switching Protocols",102:"Processing",103:"Early Hints",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a Teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Too Early",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"},C=P;function N(e){if(!Object.prototype.hasOwnProperty.call(P.message,e))throw new Error("invalid status code: "+e);return P.message[e]}function P(e){if("number"==typeof e)return N(e);if("string"!=typeof e)throw new TypeError("code must be a number or string");var t=parseInt(e,10);return isNaN(t)?function(e){var t=e.toLowerCase();if(!Object.prototype.hasOwnProperty.call(P.code,t))throw new Error('invalid status message: "'+e+'"');return P.code[t]}(e):N(t)}P.message=x,P.code=function(e){var t={};return Object.keys(e).forEach((function(s){var o=e[s],i=Number(s);t[o.toLowerCase()]=i})),t}(x),P.codes=function(e){return Object.keys(e).map((function(e){return Number(e)}))}(x),P.redirect={300:!0,301:!0,302:!0,303:!0,305:!0,307:!0,308:!0},P.empty={204:!0,205:!0,304:!0},P.retry={502:!0,503:!0,504:!0};const j=new URL(new URL("assets/close-5578d4ce.svg",import.meta.url).href,import.meta.url).href,L=new URL(new URL("assets/info-fd0d98fe.svg",import.meta.url).href,import.meta.url).href;i.register(a,r,n,c);const $={1:"#bbb",2:"#30ab61",3:"#365bd3",4:"#ff9f40",5:"#cf3942"},E={200:1};class U extends m{static get properties(){return{error:{type:Boolean,reflect:!0},statusCodes:{type:Object,attribute:"status-codes"},_skeleton:{type:Boolean,attribute:!1},_empty:{type:Boolean,attribute:!1},_docs:{type:Boolean,attribute:!1}}}constructor(){super(),this.error=null,this.statusCodes=null,this._docs=!1}_onToggleDocs(){this._docs=!this._docs}firstUpdated(){this._ctx=this.renderRoot.getElementById("chart"),this._chart=new i(this._ctx,{type:"doughnut",options:{responsive:!0,maintainAspectRatio:!1,plugins:{datalabels:{display:!1},legend:{onClick:function(e,t){this.chart.data.labels.forEach(((s,o)=>{const i=s===t.text;var a,r;a=e.native.shiftKey,r=i,Number(a)^Number(r)&&this.chart.toggleDataVisibility(o)})),this.chart.update()},onHover:e=>{this._ctx.style.cursor="pointer"},onLeave:e=>{this._ctx.style.cursor=null},position:"right",labels:{fontFamily:"monospace",usePointStyle:!0,filter:(e,t)=>e.text!==t.labels[e.index-1]}},tooltip:{backgroundColor:"#000",displayColors:!1,callbacks:{title:([e])=>{const t=this._labels[e.dataIndex];return`HTTP ${t}: ${C.message[t]}`},label:t=>{const o=t.dataset.data,i=o.reduce(((e,t)=>e+t),0),a=o[t.dataIndex];return(({value:t,percent:o})=>{const i=w(t,"request");return`${s("en",t)} ${i} (${e("en",o)})`})({value:a,percent:a/i})}}}},animation:{duration:0}}})}updated(e){if(e.has("statusCodes")){this._skeleton=null==this.statusCodes;const e=this._skeleton?E:this.statusCodes;this._empty=0===Object.keys(e).length,this._labels=Object.keys(e),this._chartLabels=this._skeleton?this._labels.map((()=>"???")):this._labels.map((e=>e[0]+"xx")),this._data=Object.values(e),this._backgroundColor=this._skeleton?this._labels.map((()=>"#bbb")):this._labels.map((e=>$[e[0]])),this.updateComplete.then((()=>{this._chart.options.animation.duration=this._skeleton?0:300,this._chart.options.plugins.tooltip.enabled=!this._skeleton,this._chart.data={labels:this._chartLabels,datasets:[{data:this._data,backgroundColor:this._backgroundColor}]},this._chart.update()}))}super.updated(e)}render(){const e=!this.error&&!this._empty&&!this._docs,t=this.error&&!this._docs,s=this._empty&&!this._docs,o=this._docs;return b`<div class="tile_title tile_title--image">HTTP response codes<cc-button class=docs-toggle image=${o?j:L} hide-text @cc-button:click=${this._onToggleDocs}>${this._docs?"Display chart":"About this chart..."}</cc-button></div>${R(e?b`<div class=tile_body><div class="${f({skeleton:this._skeleton})} chart-container"><canvas id=chart></canvas></div></div>`:"")} ${s?b`<div class=tile_message>No data to display for now.</div>`:""} ${t?b`<cc-error class=tile_message>Something went wrong while loading HTTP response codes.</cc-error>`:""}<div class="${f({"tile_docs--hidden":!o})} tile_docs"><p>Repartition of HTTP response codes returned in the last 24 hours. Click on legend items to show/hide HTTP code categories.</p><p>${T}</p></div>`}static get styles(){return[y,g,v,_`.tile_title{align-items:center;display:flex;justify-content:space-between}.docs-toggle{font-size:1rem;margin:0 0 0 1rem}.tile_body{position:relative}.chart-container{height:100%;min-width:0;position:absolute;width:100%}.tile_body,.tile_docs,.tile_message{grid-area:2/1/2/1}.tile_docs{align-self:center;font-size:.9rem;font-style:italic}.tile_docs.tile_docs--hidden{visibility:hidden}.tile_docs_link{color:#2b96fd;text-decoration:underline}`]}}window.customElements.define("cc-tile-status-codes",U);export{U as CcTileStatusCodes};
