import"./cc-button-0fc35634.js";import"./cc-flex-gap-4e6ab5ba.js";import"./cc-error-8d730ec3.js";import"./cc-zone-280ca68f.js";import{L as t,d as e,h as s,a as i,i as a,s as n,w as r,c as o}from"./vendor-5e139a4e.js";import{c,l}from"./cc-link-bb132771.js";const m=new URL(new URL("assets/git-9772156e.svg",import.meta.url).href,import.meta.url).href,d=new URL(new URL("assets/restart-failed-1bdb53dc.svg",import.meta.url).href,import.meta.url).href,p=new URL(new URL("assets/restarting-with-downtime-f8e9df23.svg",import.meta.url).href,import.meta.url).href,u=new URL(new URL("assets/restarting-b53bf52a.svg",import.meta.url).href,import.meta.url).href,g=new URL(new URL("assets/running-cada7a10.svg",import.meta.url).href,import.meta.url).href,h=new URL(new URL("assets/start-failed-2f874290.svg",import.meta.url).href,import.meta.url).href,f=new URL(new URL("assets/starting-3ce177c7.svg",import.meta.url).href,import.meta.url).href,b=new URL(new URL("assets/stopped-d4aeda43.svg",import.meta.url).href,import.meta.url).href,$=new URL(new URL("assets/unknown-d36353e6.svg",import.meta.url).href,import.meta.url).href,w={git:m,running:g,starting:f},_={"restart-failed":d,restarting:u,"restarting-with-downtime":p,running:g,"start-failed":h,starting:f,stopped:b},U={name:"??????????????????????????",commit:"????????????????????????????????????????"};class v extends t{static get properties(){return{app:{type:Object},disableButtons:{type:Boolean,attribute:"disable-buttons",reflect:!0},error:{type:Boolean,reflect:!0},runningCommit:{type:String,attribute:"running-commit"},startingCommit:{type:String,attribute:"starting-commit"},status:{type:String},zone:{type:Object},_lastUserAction:{type:String,attribute:!1}}}constructor(){super(),this.disableButtons=!1,this.error=!1}_getCommitTitle(t,e){if(null!=e)return"git"===t?(({commit:t})=>`git repo version (HEAD): ${t}`)({commit:e}):"running"===t?(({commit:t})=>`running version: ${t}`)({commit:e}):"starting"===t?(({commit:t})=>`deploying version: ${t}`)({commit:e}):void 0}_getStatusMsg(t){return"restart-failed"===t?"Your application is running! The last deployment failed,":"restarting"===t||"restarting-with-downtime"===t?"Your application is restarting...":"running"===t?"Your application is running!":"start-failed"===t?"Your application is currently stopped. The last deployment failed,":"starting"===t?"Your application is starting...":"stopped"===t?"Your application is currently stopped.":"Unknown state, try to restart the application or contact our support if you have additional questions."}_getLastUserActionMsg(){return"start"===this._lastUserAction?"Your application is about to start...":"restart"===this._lastUserAction?"A new deployment is about to begin...":"cancel"===this._lastUserAction?"This deployment has been cancelled.":"stop"===this._lastUserAction?"Your application is about to stop...":void 0}_onStart(t){this._lastUserAction="start",e(this,"start",t)}_onRestart(t){this._lastUserAction="restart",e(this,"restart",t)}_onCancel(){this._lastUserAction="cancel",e(this,"cancel")}_onStop(){this._lastUserAction="stop",e(this,"stop")}update(t){t.has("status")&&(this._lastUserAction=t.get("status")!==this.status?null:this._lastUserAction),super.update(t)}render(){if(this.error)return s`<cc-error>Something went wrong while loading app info.</cc-error>`;const t=null==this.app,{name:e,commit:n,variantName:r,variantLogo:o,lastDeploymentLogsUrl:l}=t?U:this.app,m=null==this.status,d=m?"unknown":this.status,p=["restarting","restarting-with-downtime","starting"].includes(d),u=["restart-failed","restarting","running"].includes(d),g=null!=this._lastUserAction||this.disableButtons,h=["start-failed","stopped","unknown"].includes(d),f=["start-failed","stopped"].includes(d),b=m||["restart-failed","running","unknown"].includes(d),w="start"!==this._lastUserAction&&"stop"!==this._lastUserAction,v=["restart-failed","restarting","restarting-with-downtime","starting","start-failed"].includes(d),y=this.disableButtons?"You are not authorized to perform those actions":void 0;return s`<cc-flex-gap class=main><div class="${i({skeleton:t})} flavor-logo" title=${a(r)}><img class=flavor-logo_img src=${a(o)} alt=""></div><div class=details><div class=name><span class=${i({skeleton:t})}>${e}</span></div><cc-flex-gap class=commits>${this._renderCommit(n,"git",t)} ${u?this._renderCommit(this.runningCommit,"running",t):""} ${p?this._renderCommit(this.startingCommit,"starting",t):""}</cc-flex-gap></div><cc-flex-gap class=buttons>${f?s`<cc-button title=${a(y)} ?disabled=${g} @cc-button:click=${()=>this._onStart("normal")}>Start</cc-button><cc-button title=${a(y)} ?disabled=${g} @cc-button:click=${()=>this._onStart("rebuild")}>Re-build and start</cc-button><cc-button title=${a(y)} ?disabled=${g} @cc-button:click=${()=>this._onStart("last-commit")}>Start last pushed commit</cc-button>`:""} ${b?s`<cc-button title=${a(y)} ?skeleton=${m} ?disabled=${g} @cc-button:click=${()=>this._onRestart("normal")}>Restart</cc-button><cc-button title=${a(y)} ?skeleton=${m} ?disabled=${g} @cc-button:click=${()=>this._onRestart("rebuild")}>Re-build and restart</cc-button><cc-button title=${a(y)} ?skeleton=${m} ?disabled=${g} @cc-button:click=${()=>this._onRestart("last-commit")}>Restart last pushed commit</cc-button>`:""} ${p?s`<cc-button warning outlined title=${a(y)} ?disabled=${g} @cc-button:click=${this._onCancel}>Cancel deployment</cc-button>`:""}<cc-button danger outlined delay=3 title=${a(y)} ?skeleton=${m} ?disabled=${g||h} @cc-button:click=${this._onStop}>Stop app</cc-button></cc-flex-gap></cc-flex-gap><cc-flex-gap class="${i({"cc-waiting":p})} messages">${w?s`<img class=status-icon src=${_[d]||$} alt=""> <span class=${i({skeleton:m})}>${this._getStatusMsg(d)} </span>${v?c(l,"read logs here"):""}`:""} ${null!=this._lastUserAction?s`${this._getLastUserActionMsg()}`:""} ${null!=this.zone?s`<span class=spacer></span><cc-zone .zone=${this.zone} mode=small-infra></cc-zone>`:""}</cc-flex-gap>`}_renderCommit(t,e,n){return null==t&&"git"!==e?"":s`<span class="${i({"cc-waiting":"starting"===e})} commit" title=${a(n?void 0:this._getCommitTitle(e,t))} data-type=${e}><img class=commit_img src=${w[e]} alt=""> ${null!=t?s`<span class=${i({skeleton:n})}>${t.slice(0,8)}<span class=commit_rest>${t.slice(8)}</span></span>`:""} ${null==t?s`<span>no commits yet</span>`:""}</span>`}static get styles(){return[n,l,r,o`:host{--cc-gap:1rem;background-color:#fff;border:1px solid #bcc2d1;border-radius:.25rem;display:block}cc-error{padding:var(--cc-gap);text-align:center}.main{padding:var(--cc-gap)}.flavor-logo{align-self:flex-start;border-radius:.25rem;height:3.25rem;overflow:hidden;width:3.25rem}.flavor-logo_img{display:block;height:100%;width:100%}.skeleton .flavor-logo_img{opacity:0}.details{display:flex;flex:1 1 0;flex-direction:column;justify-content:space-between}.name{font-size:1.1rem;font-weight:700;min-width:12rem}.commit{align-items:flex-start;display:flex}.commit[data-type=git]{color:#5d5d5d}.commit[data-type=running]{color:#2faa60}.commit[data-type=starting]{color:#2b96fd}.commit_img{height:1.1rem;margin-right:.2rem;overflow:hidden;width:1.1rem}.commit_rest{font-size:0}.buttons{align-self:center}cc-button{flex:1 1 auto;min-width:0}:host([disable-buttons]) cc-button{cursor:not-allowed}.messages{--cc-gap:0.5rem;--cc-align-items:center;align-items:center;background-color:#f1f5ff;box-shadow:inset 0 6px 6px -6px #a4b1c9;box-sizing:border-box;color:#2e2e2e;font-size:.9rem;font-style:italic;padding:.4rem 1rem}.status-icon{height:1.25rem;min-width:1.25rem}.spacer{flex:1 1 0}cc-zone{font-style:normal;white-space:nowrap}[title]{cursor:help}.skeleton{background-color:#bbb}`]}}window.customElements.define("cc-header-app",v);export{v as CcHeaderApp};
