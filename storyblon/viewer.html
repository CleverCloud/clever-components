<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>@Storyblon</title>
  <style>
  html,
  body {
    margin: 0;
  }

  body {
    font-family: Arial, "Helvetica Neue", Helvetica, sans-serif;
    margin: 1em;
  }

  body > * {
    margin-bottom: 1em;
  }
  </style>
  <script type="module">

  const searchParams = new URL(location.href).searchParams;

  const lang = searchParams.get('lang');
  if (lang !== 'none') {
    Promise
      .all([
        import('/src/lib/i18n.js'),
        import('/src/translations/translations.' + lang + '.js'),
      ])
      .then(([{ addTranslations, setLanguage }, { lang, translations }]) => {
        addTranslations(lang, translations);
        setLanguage(lang);
      });
  }

  const notDefined = searchParams.get('nnot-defined') === 'true';
  const componentName = searchParams.get('component');
  if (!notDefined) {
    import(`/src/components/${componentName}/${componentName}.js`);
  }
  import((`/src/components/${componentName}/${componentName}.variants.js`)).then(({ variants, style }) => {
    const $fragment = document.createDocumentFragment();
    for (const properties of variants) {
      const $component = document.createElement(componentName);
      for (const [name, value] of Object.entries(properties)) {
        $component[name] = value;
      }
      $fragment.appendChild($component);
    }

    document.body.appendChild($fragment);

    if (style != null) {
      const $style = document.createElement('style');
      $style.textContent = style;
      document.head.appendChild($style);
    }
  });

  const textZoom = searchParams.get('text-zoom');
  if (textZoom != null) {
    const $style = document.createElement('style');
    $style.textContent = `
      html { font-size: ${textZoom} }
    `;
    // body { font-size: 16px }
    document.head.appendChild($style);
  }

  </script>
</head>
<body>
</body>
</html>
